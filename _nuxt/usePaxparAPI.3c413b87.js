import{m as U,y as D,O as _,l as z}from"./entry.73f850e2.js";import{u as W}from"./fetch.99c3aab9.js";import{u as E}from"./url.6edfad5e.js";import{u as q}from"./useToast.2d2c16cf.js";function m(){return U("backend",()=>{const e=E(),u=z().public.backendForced,r=e.hostname;var s,t;return u!==void 0?(s=u,t="forcing via runtine config !!!!"):r==="localhost"?(s="http://localhost:8881",t="hostname is localhost"):l(r,"dev")?(s="https://dev.paxpar.tech",t="hostname contains `.dev.`"):l(r,"uat")?(s="https://uat.paxpar.tech",t="hostname contains `.uat.`"):(s="https://paxpar.tech",t="no other env detected"),console.log(`ðŸ£ useBackend ${s} because ${t}`),s}).value}const N={toast:{pending:{enable:!0,delay:500,duration:3e3},success:{enable:!0,duration:3e3},error:{enable:!0,duration:3e3}}},Q=async(a,e)=>{var f,g,h,b,k,$,v,i,C,P,y,w,B,F,L,T,x,A,O,R;const n=await m(),u=await I(),r=q();e=D(N,e,{headers:{...e==null?void 0:e.headers,Authorization:`Bearer ${u}`}});var s=!0,t;(g=(f=e==null?void 0:e.toast)==null?void 0:f.pending)!=null&&g.enable&&setTimeout(()=>{var c,S;s===!0&&(t=r.loading(((S=(c=e==null?void 0:e.toast)==null?void 0:c.pending)==null?void 0:S.msg)||`${a}`))},e.toast.pending.delay);const d=await W(`${n}${a}`,e,"$rIE2mY9bQW");if(s=!1,d.error.value){const c=((b=(h=e==null?void 0:e.toast)==null?void 0:h.error)==null?void 0:b.msg)||`Error (${d.error.value.statusCode}) : ${d.error.value.message}`;($=(k=e==null?void 0:e.toast)==null?void 0:k.pending)!=null&&$.enable&&t?r.update(t,{render:c,autoClose:(v=e==null?void 0:e.toast.error)==null?void 0:v.duration,closeOnClick:!0,closeButton:!0,type:"error",isLoading:!1}):((C=(i=e==null?void 0:e.toast)==null?void 0:i.error)!=null&&C.enable||(y=(P=e==null?void 0:e.toast)==null?void 0:P.pending)!=null&&y.enable)&&r.error(c)}else{const c=((B=(w=e==null?void 0:e.toast)==null?void 0:w.success)==null?void 0:B.msg)||`${a}`;(L=(F=e==null?void 0:e.toast)==null?void 0:F.pending)!=null&&L.enable&&t?r.update(t,{render:c,autoClose:(T=e.toast.success)==null?void 0:T.duration,closeOnClick:!0,closeButton:!0,type:"success",isLoading:!1}):((A=(x=e==null?void 0:e.toast)==null?void 0:x.success)!=null&&A.enable||(R=(O=e==null?void 0:e.toast)==null?void 0:O.pending)!=null&&R.enable)&&r.success(c)}return d};function Y(a,e){const u=`${m()}${a}`,r=new URL(u);return r.searchParams.set("Authorization",`Bearer ${e}`),r.toString()}function l(a,e){return a.includes(`.${e}.`)||a.startsWith(`${e}.`)}function j(){return E().hostname}async function I(){var u;const a=await _(),{data:e,error:n}=await a.auth.getSession();return(u=e==null?void 0:e.session)==null?void 0:u.access_token}const M=()=>({addAuthURL:Y,backend:m(),domain:j(),isDomainEnv:l,useFetchPP:Q,getToken:I});export{M as u};
